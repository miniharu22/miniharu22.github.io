---
layout : single
title: "[Paper Review] Segment-Anything Model(SAM)"
categories: 
  - Post Training Quantization SAM
toc: true
toc_sticky: true
use_math: true
---

Meta AI에서 발표한 이미지 객체 분할 모델인 Segment-Anything Model에 대해 정리    

[논문 링크](https://ai.meta.com/research/publications/segment-anything/)  

- April 5 2023
- Meta AI
- [Alexander Kirillov](https://alexander-kirillov.github.io/)     

## 0. Introduction    

&nbsp;

- **Segment-Anything Model**    
  - 모든 분야에서 광범위하게 사용할 수 있는 Image segmentation model    
    - 이를 위해 광범위한 대용량 데이터셋(SA-1B)을 새롭게 만들고, 이를 학습시켜 powerful generalization을 적용     
  - 본 논문에서 강조하는 SAM의 요소에는 세 가지가 존재    
    - **Prmopt**   
      - Promptable segmentation    
      - Training sample들에 대해서 prompt들을 simulation한 후, 모델의 prediction과 GT를 비교   
    - **Model**    
      - prompt & image를 Input으로 받아 실시간으로 mask를 prediction    
    - **Data**    
      - diverse & large-scale data로 모델을 학습     
  - 학습된 모델의 성능을 평가하기 위해 추가적인 훈련 없이 pre-trained model을 새로운 task에 적용할 수 있는 Zero-shot transfer에 대해서도 실험을 진행    
  - **추론(Inference) 과정**   
    - prompt가 주어진 경우에는 prompt encoder를 통해서 해당 prompt의 embedding과 image embedding을 종합하여 최종 mask를 예측    
    - prompt가 주어지지 않은 경우에는 전체 이미지를 grid로 나누어 grid의 point들을 prompt로 제공하여 전체 이미지에 대해서 최종 mask를 예측   

&nbsp;

## 1. Segment Anything Task      
### 1-1. Prompt in NLP   

&nbsp;

- **Prompt**   
  - prompt는 NLP에서 처음 도입된 개념    
  - Chatgpt와 같은 Generative Model의 경우 사용자가 특정한 task를 요구함   
    - **예시 : classification**    
      - 예를 들어 "이 기사는 스포츠와 관련된 거야? 혹은 정치에 관련된 거야?" 라고 물어보면 이는 해당 기사의 카테고리를 '분류'하는 문제가 됨    
      - 이때, "(주어)가 (분류1)일까 혹은 (분류2)일까" 라는 prompt와 함께 학습된 경우, 위에 해당하는 질문이 분류에 해당하는 문제임을 알 수 있음    
    - **예시 : guidance**   
      - 때로는 질문에 대한 대답을 하기 위한 prompt도 존재하는데, 예를 들어 "한국의 현 대통령은 누구야?" 라고 질문한 경우, "한국의 현 대통령은 [정답]입니다" 라고 대답함   
      - 이처럼 prompt는 어떤 질문을 했을 때, 매끄러운 답변을 하는 guidance를 만들어주는 역할도 수행함     
  - 위 예시들처럼 task에 대한 guide를 제공하는 역할을 하는 prompt와 함께 학습하게 되면, 적은 양의 labeled data로도 좋은 성능을 보이며 generalization에 뛰어나기 때문에 다양한 downstream task에 대해 쉽게 학습할 수 있도록 도움을 줌    


&nbsp;

### 1-2. Segment Anything Task with Prompt Engineering   

&nbsp;

<div align="center">
  <img src="/assets/images/sam/1.png" width="80%" height="80%" alt=""/>
  <p><em></em></p>
</div>

&nbsp;

- **Task**   
  - SAM에서의 prompt는 다양한 것이 될 수 있음   
  - 위 자료의 (a)에서 볼 수 있듯이 foreground와 background를 구분하는 기준이 되거나 러프한 bbox(bounding box)나 mask가 될 수도 있음 (타겟에 대한 글이어도 상관없음)
  - 이처럼 mask를 생성하고자 하는 대상에 대한 정보를 담은 어떤 것이든 prompt가 될 수 있으며 이를 통해 다양한 downstream에 대해 zero-shot transfer가 가능함    

